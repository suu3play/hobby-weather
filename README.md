# 🌈 趣味予報 (hobby-weather)

天気予報に基づいて、あなたの趣味に最適なタイミングを提案する Web アプリケーションです。

## 📝 概要

**趣味予報**は、天気条件と趣味の特性を組み合わせて、最適な活動日をおすすめするスマートなアプリケーションです。屋外・屋内活動の違い、温度・天気の好み、降水確率や UV 指数などを総合的に分析し、7 日間の予報からベストなタイミングを提案します。

### 🎯 主な機能

-   **🚀 初期セットアップ**: 新規ユーザー向けの段階的ガイドシステム
-   **🌤️ 天気予報表示**: 現在の天気と 7 日間の詳細予報
-   **🎨 趣味管理**: 趣味の登録・編集・削除（天気の好み、温度範囲設定）
-   **🎯 おすすめ機能**: AI 風スコアリングによる最適日の提案
-   **📱 レスポンシブデザイン**: モバイル・タブレット・デスクトップ対応
-   **💾 オフライン対応**: IndexedDB によるデータキャッシュ
-   **📍 位置情報対応**: 現在地の自動取得と場所検索
-   **⚙️ 設定管理**: セットアップ状態の確認とリセット機能

## 🛠️ 技術スタック

### フロントエンド

-   **React 19.1.0** - UI ライブラリ
-   **TypeScript** - 型安全な開発
-   **Vite 7.0.0** - 高速ビルドツール
-   **Tailwind CSS v3.4.17** - ユーティリティファースト CSS

### データ管理

-   **Dexie.js 4.0.11** - IndexedDB ラッパー
-   **Zustand** - 軽量状態管理
-   **OpenWeatherMap API** - 天気データソース

### 開発ツール

-   **Vitest** - 高速テストランナー
-   **React Testing Library** - コンポーネントテスト
-   **ESLint & TypeScript** - コード品質管理

## 🚀 セットアップ手順

### 前提条件

-   Node.js 18.0.0 以上
-   npm または yarn
-   OpenWeatherMap API キー（無料プランで十分）

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd hobby-weather
```

### 2. 依存関係のインストール

```bash
npm install
```

### 3. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:5173` にアクセス

### 4. 初期セットアップ

アプリケーションを初回起動すると、自動的に初期セットアップが開始されます：

#### ステップ 1: API キー設定
1. [OpenWeatherMap](https://openweathermap.org/api)にアクセス
2. 無料アカウントを作成
3. API キーを取得（Current Weather Data API を使用）
4. アプリの設定画面で API キーを入力・テスト

#### ステップ 2: 場所設定
- 「現在地を取得」ボタンで自動取得
- または都市名を手動で入力

#### ステップ 3: 趣味登録（任意）
- 好みの趣味を登録
- 天気条件と温度範囲を設定

### 5. 環境変数の設定（任意）

開発時に API キーを事前設定したい場合は、`.env.local` ファイルを作成：

```bash
VITE_OPENWEATHER_API_KEY=your_api_key_here
```

### 6. ビルド（本番環境用）

```bash
npm run build
```

### 7. テストの実行

```bash
npm test
```

## 📱 使用方法

### 基本的な使い方

1. **初期セットアップ**
    - アプリを初回起動すると自動的にセットアップが開始
    - API キー設定 → 場所設定 → 趣味登録の順で進行
    - 必要最小限（API キー・場所）を設定すればアプリを使用可能

2. **趣味の登録・管理**
    - 「趣味管理」タブで新しい趣味を追加
    - 屋外/屋内の指定
    - 好みの天気条件を選択
    - 適温範囲を設定

3. **おすすめの確認**
    - 「おすすめ」タブで提案を確認
    - スコア順で表示される
    - 詳細をクリックして理由を確認

4. **設定の管理**
    - 「設定」タブでセットアップ状態を確認
    - API キーの変更・テスト
    - 必要に応じてセットアップをリセット

### スコアリングアルゴリズム

おすすめ度は以下の要素で計算されます：

-   **天気タイプ (40%)**: 設定した好みの天気との一致度
-   **気温 (25%)**: 設定温度範囲との適合度
-   **降水確率 (20%)**: 屋外活動への影響（屋外活動は雨に敏感）
-   **風速 (10%)**: 活動への支障度
-   **UV 指数 (5%)**: 屋外活動の安全性

### フィルター機能

-   **最小スコア**: 40-70 点の範囲で設定
-   **天気タイプ**: 晴れ、曇り、雨などで絞り込み
-   **日付範囲**: 特定期間の指定
-   **曜日**: 平日・週末の除外設定

## 🏗️ プロジェクト構造

```
src/
├── components/          # Reactコンポーネント
│   ├── hobby/          # 趣味管理関連
│   ├── weather/        # 天気表示関連
│   ├── recommendation/ # おすすめ機能関連
│   ├── setup/          # 初期セットアップ関連
│   └── settings/       # 設定画面関連
├── hooks/              # カスタムフック
├── services/           # API・データサービス
├── types/              # TypeScript型定義
├── data/               # データベース設定
└── App.tsx             # メインアプリケーション
```

### 主要コンポーネント

-   **InitialSetupFlow**: 初期セットアップフロー
-   **HobbyManager**: 趣味の CRUD 操作
-   **WeatherDisplay**: 天気予報の表示
-   **RecommendationDashboard**: おすすめ機能の統合 UI
-   **RecommendationCard**: 個別おすすめの表示
-   **RecommendationFilters**: フィルター機能
-   **SetupStatusSection**: セットアップ状態表示
-   **SetupResetSection**: セットアップリセット機能

## 🧪 テスト

### テスト実行

```bash
# 全テスト実行
npm test

# ウォッチモードでテスト
npm run test:watch

# カバレッジ確認
npm run test:coverage
```

### テスト構成

-   **単体テスト**: 各コンポーネント・サービスの機能テスト
-   **統合テスト**: コンポーネント間の連携テスト
-   **スナップショットテスト**: UI の回帰テスト

## 🚀 デプロイ

### Vercel デプロイ（推奨）

1. [Vercel](https://vercel.com)アカウントを作成
2. GitHub リポジトリと連携
3. 環境変数 `VITE_OPENWEATHER_API_KEY` を設定
4. 自動デプロイが開始

### その他のプラットフォーム

-   **Netlify**: 同様の手順でデプロイ可能
-   **GitHub Pages**: 静的サイトとしてデプロイ
-   **Docker**: Dockerfile を使用したコンテナデプロイ

## 🔧 開発ガイド

### 新機能の追加

1. 適切なディレクトリに新しいコンポーネント作成
2. TypeScript 型定義を `types/index.ts` に追加
3. 必要に応じてサービス層を更新
4. テストファイルを作成
5. 統合テストを実行

### コード規約

-   **TypeScript**: 厳密な型チェックを有効化
-   **ESLint**: 設定済みルールに従う
-   **コメント**: 主要な関数・インターフェースに日本語コメント
-   **ネーミング**: 英語での命名、日本語の UI 文言

### デバッグ

```bash
# 開発ツールでの確認
- IndexedDBの内容: Application > Storage > IndexedDB
- ネットワーク: Network タブでAPI呼び出し確認
- コンソール: エラーメッセージとログ確認
```

## 📊 パフォーマンス最適化

### 実装済み最適化

-   **コード分割**: 動的インポートによるバンドルサイズ削減
-   **キャッシュ戦略**: IndexedDB による API レスポンスキャッシュ
-   **メモ化**: React.useMemo と useCallback による再計算防止
-   **遅延読み込み**: 必要時のみデータ取得

### 推奨設定

-   API 呼び出し頻度の制限（1 時間に 1 回程度）
-   画像の最適化
-   PWA 設定によるオフライン対応

### 報告・要望

-   バグ報告: GitHub の Issues で報告
-   機能要望: Discussions で提案
-   質問: README や Wiki を確認後、Issues で質問

## 📄 ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

## 🙏 謝辞

-   **OpenWeatherMap**: 無料の天気 API を提供
-   **React Team**: 素晴らしい UI ライブラリ
-   **Tailwind CSS**: 効率的な CSS framework
-   **Vite**: 高速な開発体験
-   **TypeScript**: 型安全な開発環境

---

## 📞 サポート

問題が発生した場合は、以下の順序で確認してください：

1. **よくある問題**: README のトラブルシューティングセクション確認
2. **GitHub Issues**: 同様の問題が報告されていないか確認
3. **新しい Issue**: 上記で解決しない場合は新しい Issue を作成

**バージョン**: 1.1.0
**最終更新**: 2025 年 7 月

---

🌈 **趣味予報で、天気を味方につけた充実した日々を！** 🌈